"use strict";(self.webpackChunkspatialsense_temp=self.webpackChunkspatialsense_temp||[]).push([[588],{1588:(e,t,l)=>{l.r(t),l.d(t,{default:()=>G});var a=l(9379),r=l(3969),s=l(5895),i=l(1859),n=l(4799),o=l(2950),d=l(5043),c=l(267),u=l(3759),x=l(6465),m=l(1620),p=l(8605),h=l(5757),j=l(9432),A=l(579);const v=e=>{let{view:t,events:l,onEventClick:a,selectedDate:i,projects:o,teamMembers:d,onViewChange:v}=e;(0,c.A)();const g=l.length?l.filter((e=>{const l=new Date(e.startDate),a=new Date(e.endDate);switch(t){case"day":return(0,x.r)(l,i);case"week":const e=(0,m.k)(i),t=(0,p.$)(i);return l>=e&&l<=t||a>=e&&a<=t;case"month":return(0,h.t)(l,i);default:return!0}})):[],D=e=>{switch(e.toLowerCase()){case"completed":return"success";case"in-progress":return"info";case"pending":return"warning";case"overdue":return"error";default:return"default"}},f=e=>{switch(e.toLowerCase()){case"high":return"error";case"medium":return"warning";case"low":return"info";default:return"default"}};return(0,A.jsxs)(r.A,{children:[(0,A.jsxs)(s.A,{variant:"h6",mb:2,children:[t.charAt(0).toUpperCase()+t.slice(1)," View"]}),(0,A.jsx)(r.A,{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:2,children:g.map((e=>(0,A.jsxs)(n.A,{sx:{p:2,cursor:"pointer",borderLeft:"4px solid ".concat(e.color),"&:hover":{boxShadow:3}},onClick:()=>a(e),children:[(0,A.jsx)(s.A,{variant:"subtitle1",fontWeight:"bold",children:e.title}),(0,A.jsx)(s.A,{variant:"body2",color:"text.secondary",mb:1,children:(0,j.GP)(new Date(e.startDate),"MMM d, yyyy h:mm a")}),(0,A.jsxs)(r.A,{display:"flex",gap:1,flexWrap:"wrap",mt:1,children:[(0,A.jsx)(u.A,{label:e.status.replace("-"," "),size:"small",color:D(e.status),variant:"outlined"}),(0,A.jsx)(u.A,{label:e.priority,size:"small",color:f(e.priority),variant:"outlined"})]})]},e.id)))}),0===g.length&&(0,A.jsx)(r.A,{textAlign:"center",p:4,children:(0,A.jsx)(s.A,{variant:"body1",color:"text.secondary",children:"No events found for the selected period."})})]})};var g=l(8517),D=l(1911),f=l(2579),b=l(4527),y=l(8776),w=l(4343),C=l(256),I=l(9067),k=l(4938),W=l(7471),E=l(2947),S=l(7873),z=l(1725),P=l(6384),q=l(5877),M=l(3943),T=l(2527),U=l(4793),F=l(1179),L=l(7421),H=l(7358),N=l(7257);const V=e=>{let{open:t,onClose:l,onSubmit:n,projects:o,teamMembers:c,initialData:x={}}=e;const[m,p]=(0,d.useState)({title:"",description:"",status:"planned",priority:"medium",startDate:new Date,endDate:new Date(Date.now()+36e5),projectId:"",assignee:"",isAllDay:!1,color:"#1976d2"}),[h,j]=(0,d.useState)({});(0,d.useEffect)((()=>{if(t){var e;const t="planned",r="medium";let s="";null!==x&&void 0!==x&&x.project&&("string"===typeof x.project?s=x.project:"object"===typeof x.project&&"id"in x.project&&(s=x.project.id));let i="";null!==x&&void 0!==x&&x.assignee&&("string"===typeof x.assignee?i=x.assignee:"object"===typeof x.assignee&&"id"in x.assignee&&(i=x.assignee.id)),p({title:(null===x||void 0===x?void 0:x.title)||"",description:(null===x||void 0===x?void 0:x.description)||"",status:null!==x&&void 0!==x&&x.status&&(a=x.status,["planned","in-progress","completed","delayed","cancelled"].includes(a))?x.status:t,priority:null!==x&&void 0!==x&&x.priority&&(l=x.priority,["low","medium","high","critical"].includes(l))?x.priority:r,startDate:null!==x&&void 0!==x&&x.startDate?new Date(x.startDate):new Date,endDate:null!==x&&void 0!==x&&x.endDate?new Date(x.endDate):new Date(Date.now()+36e5),projectId:s,assignee:i,isAllDay:null!==(e=null===x||void 0===x?void 0:x.isAllDay)&&void 0!==e&&e,color:(null===x||void 0===x?void 0:x.color)||"#1976d2"}),j({})}var l,a}),[t,x]);const v=(e,t)=>{p((l=>(0,a.A)((0,a.A)({},l),{},{[e]:t}))),h[e]&&j((t=>(0,a.A)((0,a.A)({},t),{},{[e]:""})))},V=(e,t)=>{t&&(0,N.f)(t)&&v(e,t)},$=(e,t)=>{if(!t||!(0,N.f)(t))return;const l=m[e]?new Date(m[e]):new Date;l.setHours(t.getHours(),t.getMinutes()),v(e,l)};return(0,A.jsx)(g.A,{open:t,onClose:l,maxWidth:"md",fullWidth:!0,"aria-labelledby":"event-form-dialog-title",children:(0,A.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),(()=>{const e={};return m.title.trim()||(e.title="Title is required"),m.startDate||(e.startDate="Start date is required"),m.endDate?m.startDate&&m.endDate&&(0,H.Y)(m.endDate,m.startDate)&&(e.endDate="End date must be after start date"):e.endDate="End date is required",m.projectId||(e.projectId="Project is required"),j(e),0===Object.keys(e).length})()&&m.startDate&&m.endDate&&m.projectId){const e=(0,a.A)((0,a.A)({},m),{},{startDate:m.startDate,endDate:m.endDate,project:m.projectId,assignee:m.assignee,status:m.status,priority:m.priority,isAllDay:m.isAllDay});n(e),l()}},children:[(0,A.jsx)(D.A,{id:"event-form-dialog-title",children:(0,A.jsxs)(r.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,A.jsx)(s.A,{variant:"h6",component:"div",children:null!==x&&void 0!==x&&x.id?"Edit Event":"Create New Event"}),(0,A.jsx)(f.A,{onClick:l,size:"small","aria-label":"close",children:(0,A.jsx)(L.A,{})})]})}),(0,A.jsx)(b.A,{}),(0,A.jsx)(y.A,{dividers:!0,children:(0,A.jsxs)(r.A,{sx:{display:"flex",gap:3,flexDirection:{xs:"column",md:"row"}},children:[(0,A.jsxs)(r.A,{sx:{flex:2},children:[(0,A.jsx)(w.A,{fullWidth:!0,label:"Event Title",name:"title",value:m.title,onChange:e=>v("title",e.target.value),margin:"normal",required:!0,error:!!h.title,helperText:h.title}),(0,A.jsx)(w.A,{fullWidth:!0,label:"Description",name:"description",value:m.description,onChange:e=>v("description",e.target.value),margin:"normal",multiline:!0,rows:4}),(0,A.jsx)(U.$,{dateAdapter:F.h,children:(0,A.jsxs)(r.A,{sx:{display:"flex",gap:2,mt:1,flexDirection:{xs:"column",sm:"row"}},children:[(0,A.jsx)(r.A,{sx:{flex:1},children:(0,A.jsx)(M.l,{label:"Start Date",value:m.startDate,onChange:e=>V("startDate",e),slotProps:{textField:{fullWidth:!0,margin:"normal",required:!0,error:!!h.startDate,helperText:h.startDate}}})}),!m.isAllDay&&(0,A.jsx)(r.A,{sx:{flex:1},children:(0,A.jsx)(T.A,{label:"Start Time",value:m.startDate,onChange:e=>$("startDate",e),slotProps:{textField:{fullWidth:!0,margin:"normal"}}})}),(0,A.jsx)(r.A,{sx:{flex:1},children:(0,A.jsx)(M.l,{label:"End Date",value:m.endDate,onChange:e=>V("endDate",e),slotProps:{textField:{fullWidth:!0,margin:"normal",required:!0,error:!!h.endDate,helperText:h.endDate}}})}),!m.isAllDay&&(0,A.jsx)(r.A,{sx:{flex:1},children:(0,A.jsx)(T.A,{label:"End Time",value:m.endDate,onChange:e=>$("endDate",e),slotProps:{textField:{fullWidth:!0,margin:"normal"}}})})]})})]}),(0,A.jsxs)(r.A,{sx:{flex:1,minWidth:"300px"},children:[(0,A.jsxs)(C.A,{fullWidth:!0,margin:"normal",error:!!h.projectId,children:[(0,A.jsx)(I.A,{id:"project-label",children:"Project"}),(0,A.jsx)(k.A,{labelId:"project-label",name:"project",value:m.projectId,label:"Project",onChange:e=>{const t=e.target.value;v("projectId",t);const l=o.find((e=>e.id===t));null!==l&&void 0!==l&&l.color&&v("color",l.color)},required:!0,children:o.map((e=>(0,A.jsx)(W.A,{value:e.id,children:(0,A.jsxs)(r.A,{display:"flex",alignItems:"center",children:[(0,A.jsx)(r.A,{sx:{width:12,height:12,borderRadius:"50%",bgcolor:e.color||"#1976d2",mr:1}}),e.name]})},e.id)))}),h.projectId&&(0,A.jsx)(E.A,{children:h.projectId})]}),(0,A.jsxs)(C.A,{fullWidth:!0,margin:"normal",children:[(0,A.jsx)(I.A,{id:"assignee-label",children:"Assignee"}),(0,A.jsxs)(k.A,{labelId:"assignee-label",name:"assignee",value:m.assignee,label:"Assignee",onChange:e=>v("assignee",e.target.value),children:[(0,A.jsx)(W.A,{value:"",children:(0,A.jsx)("em",{children:"Unassigned"})}),c.map((e=>(0,A.jsx)(W.A,{value:e.id,children:(0,A.jsxs)(r.A,{display:"flex",alignItems:"center",children:[e.avatar?(0,A.jsx)(S.A,{src:e.avatar,alt:e.name,sx:{width:24,height:24,mr:1,fontSize:"0.75rem"}}):(0,A.jsx)(S.A,{sx:{width:24,height:24,mr:1,bgcolor:"primary.main",fontSize:"0.75rem"},children:e.name.charAt(0).toUpperCase()}),e.name]})},e.id)))]})]}),(0,A.jsxs)(C.A,{fullWidth:!0,margin:"normal",children:[(0,A.jsx)(I.A,{id:"status-label",children:"Status"}),(0,A.jsxs)(k.A,{labelId:"status-label",name:"status",value:m.status,label:"Status",onChange:e=>v("status",e.target.value),children:[(0,A.jsx)(W.A,{value:"planned",children:(0,A.jsx)(u.A,{label:"Planned",size:"small",color:"default",variant:"outlined",sx:{mr:1}})}),(0,A.jsx)(W.A,{value:"in-progress",children:(0,A.jsx)(u.A,{label:"In Progress",size:"small",color:"primary",variant:"outlined",sx:{mr:1}})}),(0,A.jsx)(W.A,{value:"completed",children:(0,A.jsx)(u.A,{label:"Completed",size:"small",color:"success",variant:"outlined",sx:{mr:1}})}),(0,A.jsx)(W.A,{value:"delayed",children:(0,A.jsx)(u.A,{label:"Delayed",size:"small",color:"warning",variant:"outlined",sx:{mr:1}})}),(0,A.jsx)(W.A,{value:"cancelled",children:(0,A.jsx)(u.A,{label:"Cancelled",size:"small",color:"error",variant:"outlined",sx:{mr:1}})})]})]}),(0,A.jsxs)(C.A,{fullWidth:!0,margin:"normal",children:[(0,A.jsx)(I.A,{id:"priority-label",children:"Priority"}),(0,A.jsxs)(k.A,{labelId:"priority-label",name:"priority",value:m.priority,label:"Priority",onChange:e=>v("priority",e.target.value),children:[(0,A.jsx)(W.A,{value:"low",children:(0,A.jsx)(u.A,{label:"Low",size:"small",color:"success",variant:"outlined",sx:{mr:1}})}),(0,A.jsx)(W.A,{value:"medium",children:(0,A.jsx)(u.A,{label:"Medium",size:"small",color:"warning",variant:"outlined",sx:{mr:1}})}),(0,A.jsx)(W.A,{value:"high",children:(0,A.jsx)(u.A,{label:"High",size:"small",color:"error",variant:"outlined",sx:{mr:1}})}),(0,A.jsx)(W.A,{value:"critical",children:(0,A.jsx)(u.A,{label:"Critical",size:"small",color:"error",sx:{mr:1,fontWeight:"bold","& .MuiChip-label":{px:1}}})})]})]}),(0,A.jsx)(z.A,{control:(0,A.jsx)(P.A,{checked:m.isAllDay,onChange:e=>v("isAllDay",e.target.checked),name:"isAllDay",color:"primary"}),label:"All day event",sx:{mt:1,display:"block"}})]})]})}),(0,A.jsx)(b.A,{}),(0,A.jsxs)(q.A,{sx:{p:2},children:[(0,A.jsx)(i.A,{onClick:l,color:"inherit",children:"Cancel"}),(0,A.jsxs)(i.A,{type:"submit",variant:"contained",color:"primary",children:[null!==x&&void 0!==x&&x.id?"Update":"Create"," Event"]})]})]})})};var $=l(2532),_=l(3637);const G=()=>{const[e,t]=(0,d.useState)("week"),[l,c]=(0,d.useState)(!1),{data:u=[],isLoading:x}=(0,$.I)({queryKey:["events"],queryFn:async()=>(await _.kQ({limit:50})).map((e=>({id:e.id,title:e.title,description:e.description||"",startDate:new Date,endDate:new Date,project:"default",assignee:"user-1",status:"planned",priority:"medium",color:"#4e73df",createdAt:new Date(e.timestamp||Date.now()),updatedAt:new Date(e.timestamp||Date.now())})))}),m=[{id:"default",name:"Default Project",color:"#4e73df"}],p=[{id:"user-1",name:"Current User",role:"User"}];return(0,A.jsxs)(r.A,{sx:{p:3},children:[(0,A.jsxs)(r.A,{sx:{display:"flex",justifyContent:"space-between",mb:3},children:[(0,A.jsx)(s.A,{variant:"h4",component:"h1",children:"Timeline"}),(0,A.jsx)(i.A,{variant:"contained",startIcon:(0,A.jsx)(o.A,{}),onClick:()=>c(!0),children:"New Event"})]}),(0,A.jsx)(n.A,{sx:{p:3,mt:2},children:(0,A.jsx)(v,{view:e,events:u.map((e=>(0,a.A)((0,a.A)({},e),{},{status:e.status,priority:e.priority}))),onEventClick:e=>{console.log("Event clicked:",e)},selectedDate:new Date,projects:m,teamMembers:p,onViewChange:e=>t(e)})}),(0,A.jsx)(V,{open:l,onClose:()=>c(!1),onSubmit:e=>{console.log("Event submitted:",e),c(!1)},projects:m,teamMembers:p})]})}}}]);
//# sourceMappingURL=588.3cf0d092.chunk.js.map